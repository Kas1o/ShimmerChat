@inject IThemeService ThemeService
@implements IDisposable

<div class="theme-toggle">
    <button 
        class="theme-toggle-btn"
        @onclick="ToggleTheme"
        title="@(ThemeService.IsDarkMode ? "切换到亮色主题" : "切换到暗色主题")"
    >
        @if (ThemeService.IsDarkMode)
        {
            <span class="bi bi-sun-fill" aria-hidden="true"></span>
        }
        else
        {
            <span class="bi bi-moon-fill" aria-hidden="true"></span>
        }
    </button>
</div>

@code {
    protected override void OnInitialized()
    {
        ThemeService.OnThemeChanged += HandleThemeChanged;
    }
    
    private void ToggleTheme()
    {
        ThemeService.ToggleTheme();
    }
    
    private void HandleThemeChanged(bool isDarkMode)
    {
        StateHasChanged();
    }
    
    public void Dispose()
    {
        ThemeService.OnThemeChanged -= HandleThemeChanged;
    }
}